/**
 ******************************************************************************
 * @file           : main.c
 * @author         : Auto-generated by STM32CubeIDE
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * Copyright (c) 2022 STMicroelectronics.
 * All rights reserved.
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *
 ******************************************************************************
 */

#include <stdint.h>
#include "stm32f407xx.h"
#if !defined(__SOFT_FP__) && defined(__ARM_FP)
  #warning "FPU is not initialized, but the project is compiling for an FPU. Please initialize the FPU before use."
#endif
typedef unsigned long uint32_t;

#define FLASH_BASE			  0x08000000UL
#define SRAM1_BASE            0x20000000UL
#define SRAM2_BASE            0x2001C000UL
#define PERIPH_BASE			  0x40020000UL

//define APB1PERIPH_BASE       PERIPH_BASE
//#define APB2PERIPH_BASE       (PERIPH_BASE + 0x00010000UL)
//#define AHB1PERIPH_BASE       (PERIPH_BASE + 0x00020000UL)
//#define AHB2PERIPH_BASE       (PERIPH_BASE + 0x10000000UL)
#define GPIOD_BASE            (PERIPH_BASE + 0x0C00UL)

#define SRAM_SIZE  		(192 + 4)*1024
#define SRAM_END        (SRAM1_BASE + SRAM_SIZE)

#define RCC_BASE 		(PERIPH_BASE + 0x3800UL)
#define RCC_AHB1ENR		((uint32_t *)(RCC_BASE +0x30))

#define GPIOD_MODER		((uint32_t*) (GPIOD_BASE + 0x00))
#define GPIOD_ODR		((uint32_t*) (GPIOD_BASE + 0x14))



int main(void);
void delay(uint32_t count);

uint32_t *vector_table[]  __attribute__((section(".isr_vector"))) = {
		(uint32_t*)SRAM_END,
		(uint32_t*)main
};

int main(void){
	*RCC_AHB1ENR = (1<<3);
	*GPIOD_MODER |= 0x400;

	while(1){
		*GPIOD_ODR = 0xFFFF;
		delay(200000);
		*GPIOD_ODR = 0xFFFF;
		delay(200000);
	}



}
void delay(uint32_t count)
{
	while(count--);
	}
